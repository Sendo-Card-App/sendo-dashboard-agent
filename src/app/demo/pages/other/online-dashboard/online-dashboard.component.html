<div class="row">
  <!-- Section v√©rification KYC -->
  <section class="welcome-section" *ngIf="!isverifiedkyc">
    <div class="container">
      <h1 class="welcome-title">üëã V√©rification d'identit√©</h1>
      <p class="welcome-subtitle">Finalisez votre inscription en v√©rifiant votre identit√©. Cette √©tape est obligatoire pour acc√©der √† toutes les fonctionnalit√©s.</p>
      <div class="actions-container">
        <a routerLink="/verification" class="action-btn primary">Commencer la v√©rification</a>
      </div>
    </div>
  </section>

  <!-- Contenu principal lorsque KYC v√©rifi√© -->
  <div class="col-12" *ngIf="isverifiedkyc">

    <!-- Filtres des statistiques -->
    <!-- <app-card cardTitle="Filtres des Statistiques" cardClass="filter-card">
      <div class="filter-content">
        <div class="row g-3">
          <div class="col-md-4">
            <label class="form-label">Date de d√©but</label>
            <input
              type="date"
              [(ngModel)]="dateFilter.startDate"
              class="form-control"
            >
          </div>
          <div class="col-md-4">
            <label class="form-label">Date de fin</label>
            <input
              type="date"
              [(ngModel)]="dateFilter.endDate"
              class="form-control"
            >
          </div>
          <div class="col-md-4 d-flex align-items-end">
            <div class="d-flex gap-2 w-100">
              <button class="btn btn-primary flex-fill" (click)="applyFilters()" [disabled]="isLoading">
                <i class="ti ti-filter me-2"></i>
                Appliquer
              </button>
              <button class="btn btn-outline-secondary flex-fill" (click)="clearFilters()" [disabled]="isLoading">
                <i class="ti ti-filter-off me-2"></i>
                Effacer
              </button>
            </div>
          </div>
        </div>
      </div>
    </app-card> -->

    <!-- 4 Blocs de statistiques -->
    <div class="row mt-4">
      @for (summary of dashboard_summary; track summary) {
      <div class="col-lg-3 col-md-6">
        <app-card [showHeader]="false" [padding]="20">
          <div class="flex align-item-center">
            <div class="flex-shrink-0">
              <div class="avatar avatar-s {{ summary.background }}">
                <svg class="pc-icon">
                  <use attr.xlink:href="assets/fonts/custom-icon.svg{{ summary.icon }}"></use>
                </svg>
              </div>
            </div>
            <div class="flex-grow-1 m-l-15">
              <p class="m-b-5 f-w-500">{{ summary.title }}</p>
              <div class="flex align-item-center justify-content-between">
                <div class="f-16 f-w-600">{{ summary.value }}</div>
                <span class="{{ summary.color }}">
                  <i class="ti {{ summary.trend === 'up' ? 'ti-trending-up' : summary.trend === 'down' ? 'ti-trending-down' : 'ti-minus' }} m-r-5"></i>
                  {{ summary.percentage }}
                </span>
              </div>
            </div>
          </div>
        </app-card>
      </div>
      }
    </div>

    <!-- Informations du marchand et frais r√©cents -->
    <div class="row mt-4">
      <!-- Informations du marchand -->
      <div class="col-lg-6">
        <app-card cardTitle="Informations du Marchand">
          <div class="merchant-info" *ngIf="statisticsData">
            <div class="merchant-header">
              <div class="merchant-avatar">
                {{ statisticsData.merchant.user.name.charAt(0) }}
              </div>
              <div class="merchant-details">
                <h4 class="merchant-name">{{ statisticsData.merchant.user.name }}</h4>
                <p class="merchant-email">{{ statisticsData.merchant.user.email }}</p>
                <p class="merchant-phone">{{ statisticsData.merchant.user.phone }}</p>
              </div>
            </div>
            <div class="merchant-stats">
              <div class="stat-item">
                <span class="stat-label">Type de compte</span>
                <span class="stat-value">{{ statisticsData.merchant.typeAccount }}</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Statut</span>
                <span class="stat-value status-badge {{ statisticsData.merchant.status.toLowerCase() }}">
                  {{ statisticsData.merchant.status }}
                </span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Solde total</span>
                <span class="stat-value highlight">{{ formatCurrency(statisticsData.merchant.balance) }}</span>
              </div>
            </div>
          </div>
        </app-card>
      </div>

      <!-- Frais r√©cents -->
      <div class="col-lg-6">
        <app-card cardTitle="Frais R√©cents">
          <div class="recent-fees" *ngIf="statisticsData">
            <div class="fees-list">
              <div class="fee-item" *ngFor="let fee of statisticsData.recentFees">
                <div class="fee-icon">
                  <i class="ti ti-receipt"></i>
                </div>
                <div class="fee-content">
                  <div class="fee-amount">{{ formatCurrency(fee.amount) }}</div>
                  <div class="fee-details">
                    <span class="fee-id">{{ fee.transaction.id }}</span>
                    <span class="fee-date">{{ formatDate(fee.createdAt) }}</span>
                  </div>
                  <div class="fee-status {{ getStatusClass(fee.transaction.status) }}">
                    {{ getStatusLabel(fee.transaction.status) }}
                  </div>
                </div>
              </div>
              <div class="no-fees" *ngIf="statisticsData.recentFees.length === 0">
                <i class="ti ti-receipt-off"></i>
                <span>Aucun frais r√©cent</span>
              </div>
            </div>
          </div>
        </app-card>
      </div>
    </div>

    <!-- Deux graphiques en bas -->
    <div class="row mt-4">
      <!-- Graphique de r√©partition du solde -->
      <div class="col-lg-6">
        <app-card cardTitle="R√©partition du Solde">
          <div class="chart-container">
            <div class="balance-chart">
              <div class="chart-visual">
                <div class="doughnut-chart">
                  <div class="chart-center">
                    <div class="chart-total">{{ formatCurrency(statisticsData?.merchant.balance || 0) }}</div>
                    <div class="chart-label">Total</div>
                  </div>
                </div>
              </div>
              <div class="chart-legend">
                <div class="legend-item" *ngFor="let item of balanceDistributionData.labels; let i = index">
                  <div class="legend-color" [style.background]="balanceDistributionData.colors[i]"></div>
                  <div class="legend-text">
                    <span class="legend-label">{{ item }}</span>
                    <span class="legend-value">{{ balanceDistributionData.series[i].toFixed(1) }}%</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </app-card>
      </div>

      <!-- Graphique des tendances de transactions -->
      <div class="col-lg-6">
        <app-card cardTitle="Tendances des Transactions">
          <div class="chart-container">
            <div class="trends-chart">
              <div class="chart-bars">
                <div class="bar-container" *ngFor="let value of transactionTrendsData.series; let i = index">
                  <div class="bar" [style.height]="(value / 70) * 100 + '%'">
                    <div class="bar-value">{{ value }}</div>
                  </div>
                  <div class="bar-label">{{ transactionTrendsData.categories[i] }}</div>
                </div>
              </div>
            </div>
          </div>
        </app-card>
      </div>
    </div>
  </div>
</div>
